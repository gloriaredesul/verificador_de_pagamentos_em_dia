# ğŸ“Œ Passo 1: Importar bibliotecas
import pandas as pd
from google.colab import files
import io
import locale

# ğŸ“Œ Passo 2: Definir locale para meses em portuguÃªs
try:
    locale.setlocale(locale.LC_TIME, 'pt_BR.utf8')
except:
    try:
        locale.setlocale(locale.LC_TIME, 'pt_BR.UTF-8')
    except:
        print("âš ï¸ Locale em pt_BR nÃ£o disponÃ­vel. Meses podem aparecer em inglÃªs.")

# ğŸ“Œ Passo 3: Upload do arquivo
print("ğŸ“ FaÃ§a o upload da planilha (.xlsx ou .csv):")
uploaded = files.upload()

# ğŸ“Œ Passo 4: Leitura da planilha
filename = list(uploaded.keys())[0]

if filename.endswith('.xlsx'):
    df = pd.read_excel(io.BytesIO(uploaded[filename]))
elif filename.endswith('.csv'):
    df = pd.read_csv(io.BytesIO(uploaded[filename]))
else:
    raise ValueError("Formato nÃ£o suportado. Envie .xlsx ou .csv")

# ğŸ“Œ Passo 5: Padronizar nomes de colunas
df.columns = df.columns.str.strip().str.lower()

# ğŸ“Œ Passo 6: Verificar se colunas esperadas existem
if 'vencimento' not in df.columns or 'pagamento' not in df.columns:
    raise ValueError(f"Colunas esperadas nÃ£o encontradas. Colunas disponÃ­veis: {df.columns.tolist()}")

# ğŸ“Œ Passo 7: Converter datas
df['vencimento'] = pd.to_datetime(df['vencimento'], errors='coerce')
df['pagamento'] = pd.to_datetime(df['pagamento'], errors='coerce')

# ğŸ“Œ Passo 8: Identificar pagamentos em dia
em_dia = (
    (df['vencimento'].dt.month == df['pagamento'].dt.month) &
    (df['vencimento'].dt.year == df['pagamento'].dt.year)
)

# ğŸ“Œ Passo 9: Listar apenas os meses e anos dos pagamentos em dia
meses_em_dia = df.loc[em_dia, 'pagamento'].dt.to_period('M').dropna().unique()

# Converter para formato legÃ­vel (ex: MarÃ§o/2024)
meses_formatados = [p.to_timestamp().strftime('%B/%Y').capitalize() for p in meses_em_dia]

# ğŸ“Œ Passo 10: Exibir resultado
print("\nâœ… Meses e anos com pagamentos em dia:")
for mes in meses_formatados:
    print(f"- {mes}")
